<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Spring Security with Radius Login in Spring Boot - blog.pavelsklenar.com</title><meta name=description content="Personal blog page"><meta property="og:title" content="Spring Security with Radius Login in Spring Boot">
<meta property="og:description" content="In this example, we will secure a home page (/home) with Spring Security using Radius authentication.
Technologies used:
 Spring Boot 2.0.4.RELEASE TinyRadius 1.0.1 Embedded Tomcat 8.5.23  Quick Overview:
 Create a new base Spring Boot project with required dependencies Create a simple login using Spring Security Create your own RadiusAuthenticationProvider Simple test with a real Radius Server  1. Project Structure Project structure&#34; Project structure 
2. Create a new base Spring Boot project We will start with a new project generated by Spring Initializr.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.pavelsklenar.com/spring-security-radius-login/"><meta property="og:image" content="https://blog.pavelsklenar.com/logo.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-01-23T00:00:00+00:00">
<meta property="article:modified_time" content="2021-09-20T22:40:20+02:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.pavelsklenar.com/logo.png">
<meta name=twitter:title content="Spring Security with Radius Login in Spring Boot">
<meta name=twitter:description content="In this example, we will secure a home page (/home) with Spring Security using Radius authentication.
Technologies used:
 Spring Boot 2.0.4.RELEASE TinyRadius 1.0.1 Embedded Tomcat 8.5.23  Quick Overview:
 Create a new base Spring Boot project with required dependencies Create a simple login using Spring Security Create your own RadiusAuthenticationProvider Simple test with a real Radius Server  1. Project Structure Project structure&#34; Project structure 
2. Create a new base Spring Boot project We will start with a new project generated by Spring Initializr.">
<meta name=application-name content="blog.pavelsklenar.com">
<meta name=apple-mobile-web-app-title content="blog.pavelsklenar.com"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.pavelsklenar.com/spring-security-radius-login/><link rel=prev href=https://blog.pavelsklenar.com/spring-integration-sftp-download/><link rel=next href=https://blog.pavelsklenar.com/how-to-install-ubuntu-on-synology/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.623091c4f3b927646c79b3db3772f496ee423628b9567bc0c74af55a4d50d1ba.css integrity="sha256-YjCRxPO5J2RsebPbN3L0lu5CNii5VnvAx0r1Wk1Q0bo="><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Spring Security with Radius Login in Spring Boot","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.pavelsklenar.com\/spring-security-radius-login\/"},"image":[{"@type":"ImageObject","url":"https:\/\/blog.pavelsklenar.com\/images\/Apple-Devices-Preview.png","width":3200,"height":2048}],"genre":"posts","keywords":"docker, radius, spring-boot","wordcount":821,"url":"https:\/\/blog.pavelsklenar.com\/spring-security-radius-login\/","datePublished":"2018-01-23T00:00:00+00:00","dateModified":"2021-09-20T22:40:20+02:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Pavel Sklenar","logo":{"@type":"ImageObject","url":"https:\/\/blog.pavelsklenar.com\/images\/avatar.png","width":250,"height":250}},"author":{"@type":"Person","name":"Pavel Sklenar"},"description":""}</script></head>
<body header-desktop=fixed header-mobile=auto><script type=text/javascript>('false'==='true'&&window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=blog.pavelsklenar.com><span class=header-title-pre><i class="fas fa-code-branch fa-fw"></i></span>blog.pavelsklenar.com</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/tags/> Tags </a><a class=menu-item href=/categories/> Categories </a><a class=menu-item href=/about/> About </a><a class=menu-item href=https://github.com/pajikos title=GitHub rel="noopener noreferrer" target=_blank><i class="fab fa-github fa-fw"></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=blog.pavelsklenar.com><span class=header-title-pre><i class="fas fa-code-branch fa-fw"></i></span>blog.pavelsklenar.com</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/pajikos title=GitHub rel="noopener noreferrer" target=_blank><i class="fab fa-github fa-fw"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX">Spring Security with Radius Login in Spring Boot</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i>Pavel Sklenar</a></span>&nbsp;<span class=post-category>included in <a href=/categories/java/><i class="far fa-folder fa-fw"></i>java</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2018-01-23>2018-01-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;821 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#1-project-structure>1. Project Structure</a></li>
<li><a href=#2-create-a-new-base-spring-boot-project>2. Create a new base Spring Boot project</a></li>
<li><a href=#3-create-a-simple-login-using-spring-security>3. Create a simple login using Spring Security</a></li>
<li><a href=#4-create-your-own-radiusauthenticationprovider>4. Create your own RadiusAuthenticationProvider</a></li>
<li><a href=#5-simple-test-with-a-real-radius-server>5. Simple test with a real Radius Server</a></li>
</ul>
</nav></div>
</div><div class=content id=content><p>In this example, we will secure a home page (/home) with Spring Security using <a href=https://www.cisco.com/c/en/us/support/docs/security-vpn/remote-authentication-dial-user-service-radius/12433-32.html target=_blank rel="noopener noreferrer">Radius</a> authentication.</p>
<p>Technologies used:</p>
<ol>
<li>Spring Boot 2.0.4.RELEASE</li>
<li>TinyRadius 1.0.1</li>
<li>Embedded Tomcat 8.5.23</li>
</ol>
<p>Quick Overview:</p>
<ol>
<li>Create a new base Spring Boot project with required dependencies</li>
<li>Create a simple login using Spring Security</li>
<li>Create your own RadiusAuthenticationProvider</li>
<li>Simple test with a real Radius Server</li>
</ol>
<h2 id=1-project-structure>1. Project Structure</h2>
<p><figure><a class=lightgallery href=/spring-security-radius-login/images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png title=/spring-security-radius-login/images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png data-thumbnail=/spring-security-radius-login/images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png data-sub-html="<h2>Project structure</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png data-srcset="/spring-security-radius-login/images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png, images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png 1.5x, /spring-security-radius-login/images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png 2x" data-sizes=auto alt=/spring-security-radius-login/images/2018-01-10-23_58_00-projects-Spring-radius-login_src_main_java_com_pavelsklenar_radiuslogin_auth.png>
</a><figcaption class=image-caption>Project structure</figcaption>
</figure></p>
<h2 id=2-create-a-new-base-spring-boot-project>2. Create a new base Spring Boot project</h2>
<p>We will start with a new project generated by <a href=https://start.spring.io/ target=_blank rel="noopener noreferrer">Spring Initializr</a>. Just only two Spring dependencies are required: Security and Web.</p>
<p><figure><a class=lightgallery href=/spring-security-radius-login/images/2018-01-03-21_31_30-Spring-Initializr.png title="Spring Initializr" data-thumbnail=/spring-security-radius-login/images/2018-01-03-21_31_30-Spring-Initializr.png data-sub-html="<h2>Spring Initializr</h2><p>Spring Initializr</p>">
<img class=lazyload src=/svg/loading.min.svg data-src=images/2018-01-03-21_31_30-Spring-Initializr.png data-srcset="/spring-security-radius-login/images/2018-01-03-21_31_30-Spring-Initializr.png, images/2018-01-03-21_31_30-Spring-Initializr.png 1.5x, /spring-security-radius-login/images/2018-01-03-21_31_30-Spring-Initializr.png 2x" data-sizes=auto alt=/spring-security-radius-login/images/2018-01-03-21_31_30-Spring-Initializr.png>
</a><figcaption class=image-caption>Spring Initializr</figcaption>
</figure></p>
<p>The generated project is ready to run with embedded Tomcat, but we need to add other required dependencies The first dependency is a <code>[tinyradius](http://tinyradius.sourceforge.net/)</code> as a client library to be able to call Radius server. The other two dependencies (<code>jstl</code> and <code>tomcat-embed-jasper</code>) are related to JSP pages, which will be used inside a login and a home page.</p>
<p>All required dependencies are shown here:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;dependency&gt;</span>
            <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
            <span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-security<span class=nt>&lt;/artifactId&gt;</span>
        <span class=nt>&lt;/dependency&gt;</span>
        <span class=nt>&lt;dependency&gt;</span>
            <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
            <span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-web<span class=nt>&lt;/artifactId&gt;</span>
        <span class=nt>&lt;/dependency&gt;</span>
        <span class=nt>&lt;dependency&gt;</span>
            <span class=nt>&lt;groupId&gt;</span>javax.servlet<span class=nt>&lt;/groupId&gt;</span>
            <span class=nt>&lt;artifactId&gt;</span>jstl<span class=nt>&lt;/artifactId&gt;</span>
        <span class=nt>&lt;/dependency&gt;</span>
        <span class=nt>&lt;dependency&gt;</span>
            <span class=nt>&lt;groupId&gt;</span>org.apache.tomcat.embed<span class=nt>&lt;/groupId&gt;</span>
            <span class=nt>&lt;artifactId&gt;</span>tomcat-embed-jasper<span class=nt>&lt;/artifactId&gt;</span>
            <span class=nt>&lt;scope&gt;</span>provided<span class=nt>&lt;/scope&gt;</span>
        <span class=nt>&lt;/dependency&gt;</span>
        <span class=nt>&lt;dependency&gt;</span>
            <span class=nt>&lt;groupId&gt;</span>com.hynnet<span class=nt>&lt;/groupId&gt;</span>
            <span class=nt>&lt;artifactId&gt;</span>tinyradius<span class=nt>&lt;/artifactId&gt;</span>
            <span class=nt>&lt;version&gt;</span>1.0.1<span class=nt>&lt;/version&gt;</span>
<span class=nt>&lt;/dependency&gt;</span>
</code></pre></div><p><a href=https://start.spring.io/ target=_blank rel="noopener noreferrer">Spring Initialzr</a> did usually not generate any dummy pages, so we need to add our pages, login.jsp and home.jsp.</p>
<p>We do not need an extra <code>Controller</code> class, so we register our pages into <code>ViewControllerRegistry</code> directly.</p>
<p><code>ViewController</code> is required to be able to map view to its JSP page.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=nd>@Configuration</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MvcConfig</span> <span class=kd>extends</span> <span class=n>WebMvcConfigurerAdapter</span> <span class=o>{</span>
     
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>addViewControllers</span><span class=o>(</span><span class=n>ViewControllerRegistry</span> <span class=n>registry</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>registry</span><span class=o>.</span><span class=na>addViewController</span><span class=o>(</span><span class=s>&#34;/&#34;</span><span class=o>).</span><span class=na>setViewName</span><span class=o>(</span><span class=s>&#34;home&#34;</span><span class=o>);</span>
        <span class=n>registry</span><span class=o>.</span><span class=na>addViewController</span><span class=o>(</span><span class=s>&#34;/home&#34;</span><span class=o>).</span><span class=na>setViewName</span><span class=o>(</span><span class=s>&#34;home&#34;</span><span class=o>);</span>
        <span class=n>registry</span><span class=o>.</span><span class=na>addViewController</span><span class=o>(</span><span class=s>&#34;/login&#34;</span><span class=o>).</span><span class=na>setViewName</span><span class=o>(</span><span class=s>&#34;login&#34;</span><span class=o>);</span>
    <span class=o>}</span>
 
    <span class=nd>@Bean</span>
    <span class=kd>public</span> <span class=n>InternalResourceViewResolver</span> <span class=nf>viewResolver</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>InternalResourceViewResolver</span> <span class=n>resolver</span> <span class=o>=</span> <span class=k>new</span> <span class=n>InternalResourceViewResolver</span><span class=o>();</span>
        <span class=n>resolver</span><span class=o>.</span><span class=na>setPrefix</span><span class=o>(</span><span class=s>&#34;/WEB-INF/pages/&#34;</span><span class=o>);</span>
        <span class=n>resolver</span><span class=o>.</span><span class=na>setSuffix</span><span class=o>(</span><span class=s>&#34;.jsp&#34;</span><span class=o>);</span>
        <span class=k>return</span> <span class=n>resolver</span><span class=o>;</span>
    <span class=o>}</span>
<span class=o>}</span>
</code></pre></div><h2 id=3-create-a-simple-login-using-spring-security>3. Create a simple login using Spring Security</h2>
<p>It exits many examples how to configure Spring Security, so check google if you need to customize it. We do not need any special configuration, just to secure a home page. We will display a login page for non-authenticated users, it&rsquo;s all, no more requirements, no roles.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=nd>@Configuration</span>
<span class=nd>@EnableWebSecurity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>WebSecurityConfig</span> <span class=kd>extends</span> <span class=n>WebSecurityConfigurerAdapter</span> <span class=o>{</span>
    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>configure</span><span class=o>(</span><span class=n>HttpSecurity</span> <span class=n>http</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
        <span class=n>http</span>
            <span class=o>.</span><span class=na>authorizeRequests</span><span class=o>()</span>
                <span class=o>.</span><span class=na>anyRequest</span><span class=o>().</span><span class=na>authenticated</span><span class=o>()</span>
                <span class=o>.</span><span class=na>and</span><span class=o>()</span>
            <span class=o>.</span><span class=na>formLogin</span><span class=o>()</span>
                <span class=o>.</span><span class=na>loginPage</span><span class=o>(</span><span class=s>&#34;/login&#34;</span><span class=o>)</span>
                <span class=o>.</span><span class=na>permitAll</span><span class=o>()</span>
                <span class=o>.</span><span class=na>and</span><span class=o>()</span>
            <span class=o>.</span><span class=na>logout</span><span class=o>()</span>
                <span class=o>.</span><span class=na>permitAll</span><span class=o>();</span>
    <span class=o>}</span>
<span class=o>}</span>
</code></pre></div><h2 id=4-create-your-own-radiusauthenticationprovider>4. Create your own RadiusAuthenticationProvider</h2>
<p>You need to implement your own <a href=http://www.baeldung.com/spring-security-authentication-provider target=_blank rel="noopener noreferrer"><code>AuthenticationProvider</code></a>, so the method <code>authenticate</code> is required:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>Authentication</span> <span class=nf>authenticate</span><span class=o>(</span><span class=n>Authentication</span> <span class=n>authentication</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>AuthenticationException</span> <span class=o>{</span>
        <span class=n>String</span> <span class=n>username</span> <span class=o>=</span> <span class=n>authentication</span><span class=o>.</span><span class=na>getName</span><span class=o>();</span>
        <span class=n>RadiusPacket</span> <span class=n>response</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
        <span class=kt>int</span> <span class=n>attemptCount</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
        <span class=k>while</span> <span class=o>(</span><span class=n>response</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=n>attemptCount</span><span class=o>++</span> <span class=o>&lt;</span> <span class=n>clients</span><span class=o>.</span><span class=na>size</span><span class=o>())</span> <span class=o>{</span>
            <span class=n>response</span> <span class=o>=</span> <span class=n>authenticateInternally</span><span class=o>(</span><span class=n>clients</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=n>attemptCount</span> <span class=o>-</span> <span class=n>1</span><span class=o>),</span> <span class=n>username</span><span class=o>,</span>
                    <span class=n>authentication</span><span class=o>.</span><span class=na>getCredentials</span><span class=o>().</span><span class=na>toString</span><span class=o>());</span>
        <span class=o>}</span>
        <span class=k>if</span> <span class=o>(</span><span class=n>response</span> <span class=o>==</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>logger</span><span class=o>.</span><span class=na>warn</span><span class=o>(</span><span class=s>&#34;User {}, calling radius does not return any value.&#34;</span><span class=o>,</span> <span class=n>username</span><span class=o>);</span>
            <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
        <span class=o>}</span>
        <span class=k>if</span> <span class=o>(</span><span class=n>response</span><span class=o>.</span><span class=na>getPacketType</span><span class=o>()</span> <span class=o>==</span> <span class=n>RadiusPacket</span><span class=o>.</span><span class=na>ACCESS_ACCEPT</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>logger</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;User {} successfully authenticated using radius&#34;</span><span class=o>,</span> <span class=n>username</span><span class=o>);</span>
            <span class=k>return</span> <span class=k>new</span> <span class=n>UsernamePasswordAuthenticationToken</span><span class=o>(</span><span class=n>username</span><span class=o>,</span> <span class=s>&#34;&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;());</span>
        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
            <span class=n>logger</span><span class=o>.</span><span class=na>warn</span><span class=o>(</span><span class=s>&#34;User {}, returned response {}&#34;</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=n>response</span><span class=o>);</span>
            <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
        <span class=o>}</span>
<span class=o>}</span>
</code></pre></div><p>There is nothing special in this method except working with a response from the Radius server. We accept just only RadiusPacket.ACCESS_ACCEPT which indicates, that our authentication has been successful.</p>
<p>The communication between our application (a.k.a. <a href=https://www.cisco.com/c/en/us/support/docs/security-vpn/remote-authentication-dial-user-service-radius/12433-32.html target=_blank rel="noopener noreferrer">network access server - NAS</a>) and a RADIUS server is implemented in the class NetworkAccessServer:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=kd>public</span> <span class=n>RadiusPacket</span> <span class=nf>authenticate</span><span class=o>(</span><span class=n>String</span> <span class=n>login</span><span class=o>,</span> <span class=n>String</span> <span class=n>password</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>RadiusException</span> <span class=o>{</span>
        <span class=n>AccessRequest</span> <span class=n>ar</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AccessRequest</span><span class=o>(</span><span class=n>login</span><span class=o>,</span> <span class=n>password</span><span class=o>);</span>
 
        <span class=n>ar</span><span class=o>.</span><span class=na>setAuthProtocol</span><span class=o>(</span><span class=n>AccessRequest</span><span class=o>.</span><span class=na>AUTH_PAP</span><span class=o>);</span>
 
        <span class=n>ar</span><span class=o>.</span><span class=na>addAttribute</span><span class=o>(</span><span class=n>NAS_PORT_ID</span><span class=o>,</span> <span class=n>InetAddress</span><span class=o>.</span><span class=na>getLocalHost</span><span class=o>().</span><span class=na>getHostAddress</span><span class=o>());</span>
 
        <span class=n>ar</span><span class=o>.</span><span class=na>addAttribute</span><span class=o>(</span><span class=n>NAS_IP_ADDRESS</span><span class=o>,</span> <span class=s>&#34;172.25.0.101&#34;</span><span class=o>);</span>
 
        <span class=n>RadiusPacket</span> <span class=n>response</span> <span class=o>=</span> <span class=n>radiusClient</span><span class=o>.</span><span class=na>authenticate</span><span class=o>(</span><span class=n>ar</span><span class=o>);</span>
        <span class=k>return</span> <span class=n>response</span><span class=o>;</span>
<span class=o>}</span>
</code></pre></div><p>I have used some commonly used parameters, e.g. <a href=https://www.dialogic.com/webhelp/BorderNet2020/1.0.0/WebHelp/radatt_nas_ipaddress.htm target=_blank rel="noopener noreferrer">NAS-IP-Address</a> and <a href=https://www.ietf.org/rfc/rfc2869.txt target=_blank rel="noopener noreferrer">NAS-Port-Id</a>, but you can set any other settings depends on your server.</p>
<h2 id=5-simple-test-with-a-real-radius-server>5. Simple test with a real Radius Server</h2>
<p>We have prepared our application to make a real authentication test (please check the project source code to download <a href=https://github.com/pajikos/java-examples/tree/master/spring-security-radius-login target=_blank rel="noopener noreferrer">a fully working copy</a>. Now we can simply start the Spring Boot web app:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=nv>$mvn</span> spring-boot:run
</code></pre></div><p>The home page (http://localhost:8080/) is password protected, so we need to log in first:</p>
<p><figure><a class=lightgallery href=/spring-security-radius-login/images/login.png title=/spring-security-radius-login/images/login.png data-thumbnail=/spring-security-radius-login/images/login.png data-sub-html="<h2>Login window</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=images/login.png data-srcset="/spring-security-radius-login/images/login.png, images/login.png 1.5x, /spring-security-radius-login/images/login.png 2x" data-sizes=auto alt=/spring-security-radius-login/images/login.png>
</a><figcaption class=image-caption>Login window</figcaption>
</figure></p>
<p>The real Radius server is required to make a real authentication test.</p>
<p>If you do not have any free Radius server to test, you can make your test against a Radius server running inside Docker. Thanks to Docker, you are able to run a real server in one minute, check an useful tutorial <a href=https://hub.docker.com/r/marcelmaatkamp/freeradius/ target=_blank rel="noopener noreferrer">here</a>.</p>
<p>When using pre-configured docker&rsquo;s container you can simply start a fully configured Radius server with this command:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=nv>$docker</span>-compose up -d freeradius
</code></pre></div><p>My application contains a correct configuration to call this testing Radius server as well (the 2nd server&rsquo;s configuration, servers are delimited by semicolon):</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=n>com</span><span class=o>.</span><span class=na>pavelsklenar</span><span class=o>.</span><span class=na>radius</span><span class=o>.</span><span class=na>server</span><span class=o>=</span><span class=n>192</span><span class=o>.</span><span class=na>168</span><span class=o>.</span><span class=na>1</span><span class=o>.</span><span class=na>1</span><span class=o>,</span><span class=n>secret</span><span class=o>,</span><span class=n>500</span><span class=o>;</span><span class=n>127</span><span class=o>.</span><span class=na>0</span><span class=o>.</span><span class=na>0</span><span class=o>.</span><span class=na>1</span><span class=o>,</span><span class=n>SECRET</span><span class=o>,</span><span class=n>1000</span>
</code></pre></div><p>The source code of this project could be found on my public <a href=https://github.com/pajikos/java-examples/tree/master/spring-security-radius-login target=_blank rel="noopener noreferrer">Github profile</a>. To prevent any other future changes, the fully compatible Radius server with configuration files is forked on my <a href=https://github.com/pajikos/docker-compose-applications/tree/master/freeradius target=_blank rel="noopener noreferrer">Github profile</a> as well.</p>
<p>Note: To run this project in the IntelliJ Idea (in the version 2018.2.x and above) using their Spring Boot plugin, set in the Run configuration Working directory to $MODULE_WORKING_DIR$. No other changes are required. Tips to remove provided element in the pom.xml are not required anymore.</p>
<p>Some useful links about spring Security:</p>
<ul>
<li><a href=http://www.baeldung.com/spring-security-authentication-provider target=_blank rel="noopener noreferrer">Spring Security Authentication Provider</a></li>
<li><a href=http://www.mkyong.com/spring-boot/spring-boot-spring-security-thymeleaf-example/ target=_blank rel="noopener noreferrer">Spring Boot + Spring Security + Thymeleaf example</a></li>
<li><a href=https://dzone.com/articles/spring-security-in-mvc-4-using-spring-boot target=_blank rel="noopener noreferrer">Spring Security in MVC 4 Using Spring Boot</a></li>
</ul>
</div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2021-09-20&nbsp;<a class=git-hash href=https://github.com/pajikos/commit/f5d3ae45f5183f44c2c5404fa2bb327ad1e0ed43 target=_blank rel="noopener noreferrer" title="commit by Pavel Sklenar(pavel.sklenar@cloudfield.cz) f5d3ae45f5183f44c2c5404fa2bb327ad1e0ed43: Initial migration commit">
<i class="fas fa-hashtag fa-fw"></i>f5d3ae4</a></span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md><span>
<a class=link-to-markdown href=/spring-security-radius-login/index.md target=_blank rel="noopener noreferrer">Read Markdown</a>
</span></div>
<div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.pavelsklenar.com/spring-security-radius-login/ data-title="Spring Security with Radius Login in Spring Boot" data-hashtags=docker,radius,spring-boot><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://blog.pavelsklenar.com/spring-security-radius-login/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://blog.pavelsklenar.com/spring-security-radius-login/ data-title="Spring Security with Radius Login in Spring Boot" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://blog.pavelsklenar.com/spring-security-radius-login/ data-title="Spring Security with Radius Login in Spring Boot"><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="Share on Pocket" data-sharer=pocket data-url=https://blog.pavelsklenar.com/spring-security-radius-login/><i class="fab fa-get-pocket fa-fw"></i></a><a href=javascript:void(0); title="Share on Evernote" data-sharer=evernote data-url=https://blog.pavelsklenar.com/spring-security-radius-login/ data-title="Spring Security with Radius Login in Spring Boot"><i class="fab fa-evernote fa-fw"></i></a></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/docker/>docker</a>,&nbsp;<a href=/tags/radius/>radius</a>,&nbsp;<a href=/tags/spring-boot/>spring-boot</a></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/spring-integration-sftp-download/ class=prev rel=prev title="Spring Integration: SFTP Download using Key-Based Authentication"><i class="fas fa-angle-left fa-fw"></i>Spring Integration: SFTP Download using Key-Based Authentication</a>
<a href=/how-to-install-ubuntu-on-synology/ class=next rel=next title="How to install Ubuntu on Synology">How to install Ubuntu on Synology<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id=comments><div id=disqus_thread class=comment></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.
</noscript></div></article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2015 - 2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">Pavel Sklenar</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><script type=text/javascript src=https://pavelsklenar.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:70},comment:{},search:{algoliaAppID:"FCUIGZY2I2",algoliaIndex:"index.en",algoliaSearchKey:"c8c5599716aec462e125eea72ac52f41",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.47a1ff73dc443ed4a9f13e3134f6058e8c6d21248b35d03e7d64f56345190c3e.js integrity="sha256-R6H/c9xEPtSp8T4xNPYFjoxtISSLNdA+fWT1Y0UZDD4="></script></body>
</html>